<!DOCTYPE html>
<html lang="en">
    <head>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
        <script src="https://cdn.rawgit.com/mrdoob/stats.js/r17/build/stats.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.7/gsap.min.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" />
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    </head>
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.166.1/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.166.1/examples/jsm/"
            }
        }
    </script>
    <script src="./js/CustomShader.js"></script>

    <script src="./js/sceneDef.js"></script>

    <script type="module" src="main.js"></script>
    <body>
        <div class="temp-overlay">
            <img class="band-logo" src="./assets/homeImages/band_logo.png" />
            <div class="temp-overlay-text">
                <div class="number-link">
                    <span class="chapter-name"></span>
                    <div class="dropdown">
                        <div class="track" data-scene="0" data-next="1" data-chapter="1" data-status="CLEARED">
                            초록광선
                        </div>
                        <div
                            class="track"
                            data-scene="1"
                            data-next="2"
                            data-chapter="1"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            레몬홍차
                        </div>
                        <div
                            class="track"
                            data-scene="2"
                            data-next="3"
                            data-chapter="1"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            여러가지
                        </div>
                        <div
                            class="track"
                            data-scene="3"
                            data-next="4"
                            data-chapter="1"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            시계열
                        </div>
                        <div
                            class="track"
                            data-scene="4"
                            data-next="0"
                            data-chapter="1"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            꼬리뼈
                        </div>
                    </div>
                </div>
                <div class="number-link" style="color: white" data-chapter="2">
                    <span class="chapter-name"></span>
                    <div class="dropdown">
                        <div
                            class="track"
                            data-scene="5"
                            data-next="6"
                            data-chapter="2"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            소녀
                        </div>
                        <div
                            class="track"
                            data-scene="6"
                            data-next="7"
                            data-chapter="2"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            멍
                        </div>
                        <div
                            class="track"
                            data-scene="7"
                            data-next="8"
                            data-chapter="2"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            에땅도네
                        </div>
                        <div
                            class="track"
                            data-scene="8"
                            data-next="5"
                            data-chapter="2"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            소각소각
                        </div>
                    </div>
                </div>
                <div class="number-link" style="color: white" data-chapter="3">
                    <span class="chapter-name"></span>
                    <div class="dropdown">
                        <div
                            class="track"
                            data-scene="9"
                            data-next="10"
                            data-chapter="3"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            러시아워
                        </div>
                        <div
                            class="track"
                            data-scene="10"
                            data-next="11"
                            data-chapter="3"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            KILL THE MONKEY
                        </div>
                        <div
                            class="track"
                            data-scene="11"
                            data-next="12"
                            data-chapter="3"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            KAMIKAZE BLOOM
                        </div>
                        <div
                            class="track"
                            data-scene="12"
                            data-next="9"
                            data-chapter="3"
                            data-status="CLEARED"
                            style="color: white"
                        >
                            982
                        </div>
                    </div>
                </div>
                <!-- <a class="number-link" data-scene="4" data-stage="1"></a>
                <a class="number-link" data-scene="5" data-stage="2"></a>
                <a class="number-link" data-scene="6" data-stage="2"></a>
                <a class="number-link" data-scene="7" data-stage="2"></a>
                <a class="number-link" data-scene="8" data-stage="2"></a>
                <a class="number-link" data-scene="9" data-stage="3"></a>
                <a class="number-link" data-scene="10" data-stage="3"></a>
                <a class="number-link" data-scene="11" data-stage="3"></a>
                <a class="number-link" data-scene="12" data-stage="3"></a> -->
            </div>
        </div>
        <canvas id="spectrumCanvas" width="300" height="100"></canvas>

        <canvas id="c"></canvas>
    </body>

    <script>
        const chapterListStrings = [
            "{ _ _ _ CHAPTER_01 : KICK _ _ _ }",
            "{ _ _ _ CHAPTER_02 : FUCK _ _ _ }",
            "{ _ _ _ CHAPTER_03 : KILL _ _ _ }",
        ];

        let stringIndices = [0, 0, 0];

        let stringDoneLoading = [0, 0, 0];
        function triggerTrackListAnimation() {
            // console.log(allTrackListStringsLoaded());
            document.querySelectorAll(".chapter-name").forEach((entry, i) => {
                if (stringIndices[i] < chapterListStrings[i].length) {
                    entry.textContent += chapterListStrings[i][stringIndices[i]];
                    stringIndices[i]++;
                } else {
                    stringDoneLoading[i] = 1;
                    return;
                }
            });
            setTimeout(triggerTrackListAnimation, 50);
        }

        function resetTrackListStrings() {
            document.querySelectorAll(".chapter-name").forEach((entry) => {
                entry.textContent = "";
            });
            stringIndices = [0, 0, 0];
            stringDoneLoading = [0, 0, 0];
        }

        function allTrackListStringsLoaded() {
            let sum = stringDoneLoading.reduce((a, c) => {
                return a + c;
            }, 0);
            return sum == chapterListStrings.length;
        }

        triggerTrackListAnimation();
    </script>
</html>
